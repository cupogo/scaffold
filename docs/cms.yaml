
depends:
  comm: 'hyyl.xyz/cupola/aurora/pkg/models/comm'
  oid: 'hyyl.xyz/cupola/aurora/pkg/models/oid'

modelpkg: cms1
models:
  - name: Article
    comment: '文章'
    tableTag: 'cms_article,alias:a'
    fields:
      - name: comm.DefaultModel
      - name: Author
        type: string
        tags: {json: 'author', pg: ',notnull'}
        isset: true
        comment: 作者
      - name: Title
        type: string
        tags: {json: 'title', pg: ',notnull'}
        isset: true
        comment: 标题
      - name: Contant
        type: string
        tags: {json: 'content', pg: ',notnull'}
        isset: true
        comment: 内容
    oidcat: article

  - name: Clause
    comment: '条款'
    tableTag: 'cms_clause,alias:c'
    fields:
      - name: comm.DefaultModel
      - name: Text
        type: string
        tags:
          json: 'text'
          pg: 'text,notnull'
        isset: true
    oidcat: article

stores:
  - name: contentStore
    iname: ContantStore
    methods:
      - name: ListArticle
      - name: GetArticle
      - name: CreateArticle
      - name: UpdateArticle
      - name: DeleteArticle
      - name: ListClause
      - name: GetClause
      - name: PutClause
        simple: true
      - name: DeleteClause

webapi:
  pkg: api_v1
  handles:
    - name: getCmsClause
      store: Contant
      method: GetClause
      summary: 获取内容条款
      route: '/api/v1/cms/clauses/{id} [get]'
      needAuth: true
    - name: putCmsClause
      store: Contant
      method: PutClause
      bindobj: cms1.ClauseSet
      summary: 录入内容条款
      route: '/api/v1/cms/clauses/{id} [put]'
      needAuth: true
      needPerm: true
    - name: getCmsClauses
      store: Contant
      method: ListClause
      bindobj: stores.ClauseSpec
      summary: 列出内容条款
      route: '/api/v1/cms/clauses [get]'
      needAuth: true
    - name: deleteCmsClause
      store: Contant
      method: DeleteClause
      summary: 删除内容条款
      route: '/api/v1/cms/clauses/{id} [delete]'
      needAuth: true
      needPerm: true
